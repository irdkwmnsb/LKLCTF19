# for-vm

## Условие
В сеть утёк фрагмент переписки одного из сотрудников банка с IT-отделом:
    ...

    Алексей [Бухгалтерия]: Здравствуйте! Вы мне давали виртуальную машину для работы, но там падает нужное мне
                           приложение. Не могли бы вы разобраться?

    Вячеслав [IT-отдел]:   Добрый день, Алексей! Вышлите, пожалуйста, образ виртуальной машины, я разберусь
    
    Алексей [Бухгалтерия]: <Файл: for_vm.ova>

    Вячеслав [IT-отдел]:   Спасибо, сейчас посмотрю

    Вячеслав [IT-отдел]:   Да, ошибка найдена. Для того, чтобы её исправить, сделайте следующее:

    ...

Образ виртуальной машины был загружен сюда ***(будет ссылка на гугл-диск)***

Посмотрите, может быть найдёте на диске что-то интересное

## Решение
1. Нужно зайти на виртуалку. Самое простое — сбросить пароль с LiveCD

2. Зайдя за юзера `lklctf`, обнаруживаем в его домашней папке файл `flag.txt.gpg`

3. Вспоминаем про то, что у Алексея падало какое-то приложение, смотрим core dumps: `coredumpctl list`.
Находим там один core dump приложения `tilix`. Дампаем его: `coredumpctl dump -o core.dmp tilix`

4. Запускаем tilix, чтобы удостовериться, что это эмулятор терминала

5. Что может быть интересного в core dump'е эмулятора терминала? Очевидно, отображаемое содержимое. Какое
содержимое практически гарантированно там могло быть? Наверное, приглашение командной строки (
`[lklctf@lklctf-vm]$`). Grep'аем по файлу, находим интересную строку: `[lklctf@lklctf-vm]$ pwgen -snBc 12 1`.
Pwgen — генератор паролей. Значит, его вывод — это пароль. И действительно, чуть ниже находим рандомную строку
из 12 символов, являющуюся выводом `pwgen`. Дальше — дело техники: `gpg --decrypt flag.txt.gpg`, вставляем
в качестве пароля ту 12-символьную строку и получаем флаг

## Флаг
`LKLCTF{n3veR_tRu5T_Y0uR_c0rE_DUmp5_19ae205d_d01b820e}`

## Для организаторов
Логин/пароль от виртуалки:

`lklctf` / `plucker1`       (рандомный из rockyou)

`root` / `EWvend3r`         (сгенерен pwgen'ом)

ОС: ArchLinux

## Tips & tricks (не хинты)
- Если неудобно работать из консоли, можно выполнить команду `startx` и запустить LXDE

- Вместо простого grep по бинарному файлу можно использовать vim + поиск, strings + grep, strings + vim и т.д.

## Вохможные хинты
- Обратите внимание на то, что есть какая-то упавшая программа

## Примечания
Образ виртуалки загружу либо в пятницу вечером, либо в субботу днём, как будет нормальный инет
